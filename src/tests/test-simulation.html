<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test ePuskesmas Form Simulation</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Symbols+Rounded">
    <link rel="stylesheet" href="../extension/styles/material-tokens.css">
    <link rel="stylesheet" href="../extension/styles/material-components.css">
    <style>
        body {
            background-color: var(--md-sys-color-background, #f5f5f5);
            margin: 0;
            padding: 0;
            font-family: 'Roboto', sans-serif;
        }

        .md-options-layout {
            max-width: 900px;
            margin: 0 auto;
            padding: 24px;
        }

        .md-card {
            background-color: var(--md-sys-color-surface, #ffffff);
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            margin-bottom: 24px;
        }

        .md-headline-medium {
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--md-sys-color-primary);
        }

        /* Lists and Typography */
        ul, ol {
            padding-left: 24px;
            margin: 8px 0;
        }
        
        li {
            margin-bottom: 8px;
            line-height: 1.5;
        }

        /* Code and Preformatted text */
        pre {
            background-color: var(--md-sys-color-surface-variant, #f0f0f0);
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Roboto Mono', monospace;
            font-size: 13px;
            margin: 16px 0;
            color: var(--md-sys-color-on-surface-variant);
        }

        .json-key {
            color: #d32f2f; /* Red for keys */
            font-family: monospace;
            font-weight: 500;
        }

        .form-field {
            color: #2e7d32; /* Green for values/fields */
            font-family: monospace;
            font-weight: 500;
        }

        /* Link buttons */
        .action-buttons {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 16px;
        }

        a.md-button {
            text-decoration: none;
        }
    </style>
</head>

<body>
    <div class="md-options-layout">
        <header class="md-options-header">
            <h1 class="md-headline-medium">
                <span class="material-symbols-rounded">science</span>
                ePuskesmas Form Simulation Test
            </h1>
        </header>

        <!-- Overview -->
        <section class="md-card">
            <h2 class="md-title-large">Testing Overview</h2>
            <p>This page helps you test the Medical Audio Recorder extension with the ePuskesmas form simulation. The extension should automatically populate the form fields when you generate a medical summary.</p>
        </section>

        <!-- Field Mapping -->
        <section class="md-card">
            <div class="md-section__header">
                <div class="md-section__icon">
                    <span class="material-symbols-rounded">list</span>
                </div>
                <h2 class="md-title-large">Field Mapping</h2>
            </div>
            <p>The extension maps these JSON fields to form elements:</p>
            <ul>
                <li><span class="json-key">chief_complaint</span> â†’ <span class="form-field">Anamnesa[keluhan_utama]</span></li>
                <li><span class="json-key">additional_complaint</span> â†’ <span class="form-field">Anamnesa[keluhan_tambahan]</span></li>
                <li><span class="json-key">history_of_present_illness</span> â†’ <span class="form-field">MRiwayatPasien[Riwayat Penyakit Sekarang][value]</span></li>
                <li><span class="json-key">past_medical_history</span> â†’ <span class="form-field">MRiwayatPasien[Riwayat Penyakit Dulu][value]</span></li>
                <li><span class="json-key">family_history</span> â†’ <span class="form-field">MRiwayatPasien[Riwayat Penyakit Keluarga][value]</span></li>
                <li><span class="json-key">recommended_medication_therapy</span> â†’ <span class="form-field">Anamnesa[terapi]</span></li>
                <li><span class="json-key">recommended_non_medication_therapy</span> â†’ <span class="form-field">Anamnesa[terapi_non_obat]</span></li>
                <li><span class="json-key">education</span> â†’ <span class="form-field">Anamnesa[edukasi]</span></li>
            </ul>
        </section>

        <!-- Test Steps -->
        <section class="md-card">
            <div class="md-section__header">
                <div class="md-section__icon">
                    <span class="material-symbols-rounded">rocket_launch</span>
                </div>
                <h2 class="md-title-large">Test Steps</h2>
            </div>
            <ol>
                <li><strong>Open the ePuskesmas Form Simulation:</strong> Click the button below to open the form simulation in a new tab.</li>
                <li><strong>Open the Medical Audio Recorder Extension:</strong> Click the extension icon in your browser toolbar.</li>
                <li><strong>Record or Upload Audio:</strong> Either record new audio or upload an existing audio file.</li>
                <li><strong>Transcribe:</strong> Click "Transcribe" to convert audio to text.</li>
                <li><strong>Edit Transcript (Optional):</strong> Review and edit the transcript if needed.</li>
                <li><strong>Summarize:</strong> Click "Summarize" to generate the medical summary.</li>
                <li><strong>Verify Form Population:</strong> Check that the form fields are automatically populated with the summary data.</li>
            </ol>
        </section>

        <!-- Quick Links -->
        <section class="md-card">
            <div class="md-section__header">
                <div class="md-section__icon">
                    <span class="material-symbols-rounded">link</span>
                </div>
                <h2 class="md-title-large">Quick Links</h2>
            </div>
            <div class="action-buttons">
                <a href="epuskesmas-simulation.html" target="_blank" class="md-button md-button--filled">
                    <span class="material-symbols-rounded">local_hospital</span>
                    Open ePuskesmas Form Simulation
                </a>
                <a href="example-form.html" target="_blank" class="md-button md-button--outlined">
                    <span class="material-symbols-rounded">edit_document</span>
                    Open Simple Example Form
                </a>
            </div>
        </section>

        <!-- Expected JSON Structure -->
        <section class="md-card">
            <div class="md-section__header">
                <div class="md-section__icon">
                    <span class="material-symbols-rounded">code</span>
                </div>
                <h2 class="md-title-large">Expected JSON Structure</h2>
            </div>
            <p>The extension should generate JSON in this format:</p>
            <pre>
{
  "chief_complaint": "Pasien mengeluh sakit kepala sejak 3 hari yang lalu",
  "additional_complaint": "Mual dan muntah ringan, pusing saat berdiri",
  "history_of_present_illness": "Sakit kepala berdenyut di bagian temporal, intensitas sedang",
  "past_medical_history": "Riwayat migrain 2 tahun lalu, hipertensi sejak 1 tahun",
  "family_history": "Ayah pasien memiliki riwayat hipertensi, ibu pasien diabetes",
  "recommended_medication_therapy": "Paracetamol 500mg 3x1 tablet, Omeprazole 20mg 1x1 tablet",
  "recommended_non_medication_therapy": "Istirahat cukup, hindari stres, diet rendah garam",
  "education": "Minum obat teratur, kontrol tekanan darah setiap minggu"
}</pre>
        </section>

        <!-- Troubleshooting -->
        <section class="md-card">
            <div class="md-section__header">
                <div class="md-section__icon">
                    <span class="material-symbols-rounded">build</span>
                </div>
                <h2 class="md-title-large">Troubleshooting</h2>
            </div>
            <ul>
                <li><strong>Extension not working?</strong> Make sure the extension is enabled and you have granted microphone permissions.</li>
                <li><strong>Form not populating?</strong> Check the browser console for any error messages.</li>
                <li><strong>Wrong field mapping?</strong> Verify that the form structure matches the expected ePuskesmas format.</li>
                <li><strong>API errors?</strong> Ensure your OpenAI API key is configured correctly in the extension settings.</li>
            </ul>
        </section>

        <!-- Test Data -->
        <section class="md-card">
            <div class="md-section__header">
                <div class="md-section__icon">
                    <span class="material-symbols-rounded">description</span>
                </div>
                <h2 class="md-title-large">Test Data</h2>
            </div>
            <p>You can use this sample transcript for testing:</p>
            <div style="background: var(--md-sys-color-surface-variant); padding: 16px; border-radius: 8px; border-left: 4px solid var(--md-sys-color-primary);">
                "Dokter: Selamat pagi, ada keluhan apa?<br>
                Pasien: Dokter, saya sakit kepala sudah 3 hari ini. Sakitnya berdenyut-denyut di bagian pelipis kanan. Kadang disertai mual dan muntah ringan. Kalau berdiri tiba-tiba pusing.<br>
                Dokter: Apakah ada riwayat sakit kepala sebelumnya?<br>
                Pasien: Ya dokter, 2 tahun lalu pernah migrain. Dan saya juga punya tekanan darah tinggi sejak setahun yang lalu.<br>
                Dokter: Bagaimana dengan keluarga, ada yang punya riwayat sakit kepala atau hipertensi?<br>
                Pasien: Ayah saya punya hipertensi, ibu saya diabetes.<br>
                Dokter: Baik, untuk sementara saya akan memberikan Paracetamol 500mg 3x1 tablet dan Omeprazole 20mg 1x1 tablet. Istirahat yang cukup, hindari stres, dan diet rendah garam. Minum obat teratur dan kontrol tekanan darah setiap minggu."
            </div>
        </section>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log("ðŸ§ª Test page loaded");

            // Add click tracking for analytics
            document.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', function () {
                    console.log(`ðŸ”— Link clicked: ${this.href}`);
                });
            });
        });
    </script>
</body>

</html>